use salvo::prelude::*;
use salvo::http::StatusCode;

use super::resp::handle_errors;

/// 创建错误处理中间件
pub fn stage() -> impl Handler {
    error_handler(handle_errors)
}

/// 错误处理函数
async fn error_handler<T>(status: StatusCode, res: &mut Response) -> Result<(), T> {
    handle_errors(status, res).await;
    Ok(())
}